#!/usr/bin/python3.8
import socket # Library used to perform networking functions
import time # Library used to create delays for a realistic feel

print("\n---------------- PORT SCANNER ----------------")

# User input
targetIp = input("\nEnter the IP address: ")
startPort = int(input("\nEnter the port number to start the scan from: "))
endPort = int(input("\nEnter the port number to end the scan: "))
print ("\nInitiating scan from port", startPort, "to", endPort,"\n")

try:
	# Iterate from startPort to endPort
	# endPort is added with 1 to generate an inclusive range
	for currentPort in range(startPort, endPort+1):
		# Establish a TCP network socket 
		# Source: Weidman & Eeckhoutte (2014, pp. 82-83)
		tcpNetSoc = socket.socket(
				socket.AF_INET, 
				socket.SOCK_STREAM)
		# Test connection between tcpNetSoc and currentPort
		# Returns 0 if connection is successful
		if (tcpNetSoc.connect_ex((targetIp, currentPort)) == 0): 
			# Delays for about 1.5 secs before showing user the open port
			time.sleep(1.5)
			print ("Port", currentPort, "is open.")	
			
finally:
	print ("\nScanning of ports has been completed.\n")
